---
title: 扩散模型
date: '2025-04-06 20:25:00'
updated: '2025-08-22 17:59:54'
categories:
  - 人工智能
tags:
  - 深度学习
cover: /images/custom-cover.jpg
recommend: true
---
### <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1. 从EM算法的角度分析KMeans和GMM的E步与M步</font>
#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">KMeans算法的E步和M步</font>**
**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">E步（期望步）</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">为每个样本分配最近的簇中心，隐变量为样本所属簇的硬分配（one-hot编码）。  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">数学形式：</font>

+ _<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">z</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">{</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">0</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">如果</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">ar</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">min</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∥</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∥</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">2</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">否则</font>

<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">其中，</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">z</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">表示样本</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">是否属于簇</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">。</font>

**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">M步（最大化步）</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">更新簇中心为当前簇内样本的均值：</font>

+ _<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">z</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">z</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_

#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">GMM算法的E步和M步</font>**
**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">E步</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">计算样本属于各高斯分量的后验概率（责任值）：</font>

+ _<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">K</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">π</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">j</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">π</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>

<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">其中，</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">表示样本</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">属于簇</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">的概率。</font>

**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">M步</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">更新参数以最大化完全数据对数似然：</font>

+ _<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">μ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">T</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">π</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">n</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∑</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">N</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">γ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">nk</font>_

#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">区别与联系</font>**
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">区别</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：</font>
    - **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">分配方式</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：KMeans为硬分配（离散簇标签），GMM为软分配（概率分布）。</font>
    - **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">模型假设</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：KMeans隐含各簇为球形且方差相同，GMM可建模任意协方差结构。</font>
    - **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">目标函数</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：KMeans最小化平方误差，GMM最大化对数似然。</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">联系</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：  
</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">KMeans是GMM的特例：当GMM的协方差矩阵</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">→</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">ϵ</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">I</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">（趋近于各向同性小方差），且混合系数</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">π</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">k</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">相等时，GMM的软分配退化为KMeans的硬分配。</font>

---

### <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">2. EM算法的一般形式及收敛性分析</font>
#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">EM算法一般形式</font>**
1. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">初始化</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：选择参数初值</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">0</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">。</font>
2. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">E步（期望步）</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：计算隐变量后验分布的期望（Q函数）：</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Q</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">E</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Z</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">[</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">lo</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">P</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Z</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)]</font>
3. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">M步（最大化步）</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：更新参数以最大化Q函数：</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">+</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">ar</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">max</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Q</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>
4. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">收敛判断</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：重复E步和M步，直到参数变化或对数似然变化小于阈值。</font>

#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">收敛性分析</font>**
**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">单调性</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：每次迭代后对数似然</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">lo</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">P</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">不减小，即：</font>

+ <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">lo</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">P</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">+</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">≥</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">lo</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">P</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>

<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">证明基于Jensen不等式：</font>

+ <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">lo</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">g</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">P</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Y</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∣</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">≥</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">Q</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">KL</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">散度项</font>

<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">最大化Q函数会使下界提升，从而提升对数似然。</font>

+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">局部最优</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：EM可能收敛到局部极大值，初始值敏感。</font>
+ **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">收敛条件</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：若似然函数有上界且参数空间紧致，则序列</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">{</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">θ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">i</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">}</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">必有收敛子序列。</font>

---

### <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">3. 利用BP算法更新神经网络权重</font>
#### **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">反向传播（BP）算法步骤</font>**
1. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">前向传播</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">输入样本</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">，逐层计算各层激活值：</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">a</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">h</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">+</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">b</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">h</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">a</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">其中</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">h</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">0</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">x</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">，</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">为激活函数。</font>
2. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">损失计算</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">计算输出层预测与真实标签的损失（如交叉熵、均方误差）。</font>
3. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">反向传播梯度</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">计算损失对输出的梯度</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">δ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">L</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∇</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">h</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">L</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">L</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">。</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">逐层反向传播梯度，利用链式法则：</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">δ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">+</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">T</font>__<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">δ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">+</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">⊙</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">′</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">a</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">其中</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">⊙</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">为逐元素乘法，</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">σ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">′</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> </font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">为激活函数导数。</font>
4. **<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">参数更新</font>**<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">：</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">计算权重和偏置的梯度：</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∇</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">L</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">δ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">h</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">−</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">1</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">T</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">,</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∇</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">b</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">L</font><font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">=</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">δ</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)</font>
    - <font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">使用优化算法（如SGD、Adam）更新参数：</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)←</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)−</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">η</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∇</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">W</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)L,</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">b</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)←</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">b</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)−</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">η</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">∇</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">b</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">(</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">l</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">)L其中 </font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);">η</font>_<font style="color:rgba(0, 0, 0, 0.9);background-color:rgba(255, 255, 255, 0);"> 为学习率。</font>
