---
title: 第七讲 卷积 和 图像去噪
date: '2024-07-13 11:58:29'
updated: '2025-09-16 21:56:47'
categories:
  - 人工智能
tags:
  - 深度学习
  - 计算机视觉与深度学习
cover: /images/custom-cover.jpg
recommend: true
---
### <font style="color:rgb(79, 79, 79);">一、补充材料—卷积与图像去噪</font>
<font style="color:rgb(77, 77, 77);">-1.深刻理解卷积（只有明白了卷积，才能深刻理解这个网络的作用）</font>

#### <font style="color:rgb(79, 79, 79);">（一）初识卷积操作</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">1.引子—图像去噪  
</font>![](/images/77f1bbe1f4050dec71ecf6fba22837f2.png)
+ <font style="color:rgba(0, 0, 0, 0.75);">2.卷积核  
</font>![](/images/6b37d1f088297eb55761f70aca2b485f.png)<font style="color:rgba(0, 0, 0, 0.75);">  
</font><font style="color:rgba(0, 0, 0, 0.75);">3.卷积的数学定义：  
</font>![](/images/a8bbdd0bc753355d0136c94d42bef448.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">3.1</font><font style="color:rgba(0, 0, 0, 0.75);"> </font>**<font style="color:rgba(0, 0, 0, 0.75);">应当注意</font>**<font style="color:rgba(0, 0, 0, 0.75);">，我们要将卷积核</font>**<font style="color:rgba(0, 0, 0, 0.75);">翻转180度</font>**<font style="color:rgba(0, 0, 0, 0.75);">后，再对图像进行处理，这是才是卷积操作。体现在公式中就是 H i-u,j-v 。若不反转，就对图像进行处理，称为相关。</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">3.2 但是，在课程中，卷积核通常都是对称的。也就不再强调卷积核是否旋转，但要有相关的意识。</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">4.卷积的性质：</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.1叠加性：  
</font>![](/images/1972ff22e8eceb2cde977c6fa667842e.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">4.2平移不变性：  
</font>![](/images/e6901862ccf29e2f4b30b2757a59264c.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">4.3交换律</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.4结合律</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.5分配律</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.6标量</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">5.边界填充问题</font>
    - **<font style="color:rgba(0, 0, 0, 0.75);">5.1零填充（zero-padding）</font>**
    - <font style="color:rgba(0, 0, 0, 0.75);">5.2拉伸</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">5.3镜像</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">6.小结：卷积是图像处理中一个基础而又重要的图像操作，它可以实现：平移、平滑、锐化…</font>

#### <font style="color:rgb(79, 79, 79);">（二）高斯卷积核【常用的卷积核】</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">1.高斯卷积核的公式及其权重的可视化图片  
</font>![](/images/83056dc979b53a772f0f19fb5b24fd6e.png)
+ <font style="color:rgba(0, 0, 0, 0.75);">2.高斯卷积核权重值在5*5矩阵中的具体值（σ = 1）  
</font>![](/images/fbe7caf0d44f2784b533a1fb9b504090.png)
+ <font style="color:rgba(0, 0, 0, 0.75);">3.生成步骤  
</font>![](/images/8d7cac32392a8401a376c68db3d41d77.png)
+ <font style="color:rgba(0, 0, 0, 0.75);">4.高斯卷积核中需要设置的参数：卷积核尺寸、高斯函数的标准差σ。</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.1不同高斯函数的标准差对权值的影响：标准差越小（如σ = 1），权重约向中间集中；标准差越大（如σ = 5），权重约平均。既方差越</font>**<font style="color:rgba(0, 0, 0, 0.75);">大</font>**<font style="color:rgba(0, 0, 0, 0.75);">，平滑效果越</font>**<font style="color:rgba(0, 0, 0, 0.75);">好</font>**<font style="color:rgba(0, 0, 0, 0.75);">。</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.2不同卷积核尺寸对权值的影响：尺寸越</font>**<font style="color:rgba(0, 0, 0, 0.75);">大</font>**<font style="color:rgba(0, 0, 0, 0.75);">，平滑效果越</font>**<font style="color:rgba(0, 0, 0, 0.75);">好</font>**<font style="color:rgba(0, 0, 0, 0.75);">。</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">4.3</font>**<font style="color:rgba(0, 0, 0, 0.75);">经验法则</font>**<font style="color:rgba(0, 0, 0, 0.75);">：将卷积核的半窗尺寸设置为3σ，最终卷积模板尺寸为</font>**<font style="color:rgba(0, 0, 0, 0.75);">2*3σ+1</font>**<font style="color:rgba(0, 0, 0, 0.75);">。（视频42：30有解释）</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">5.高斯卷积核的功能：</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">5.1去除图像中的“高频”成分（故又称：低通滤波器）</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">5.2两个高斯卷积卷积后得到的还是高斯卷积核</font>
    - ![](/images/b20f7946e9ae55c0c00ddb8e9036cc9a.png)
    - [【图像处理】高斯模糊、高斯函数、高斯核、高斯卷积操作_高斯卷积核-CSDN博客](https://blog.csdn.net/u013066730/article/details/123112159)
    - <font style="color:rgba(0, 0, 0, 0.75);">5.3 高斯卷积核可分离为两个一维高斯的乘积  
</font>![](/images/e041e1e46b4dabd885355fddfa3e778e.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">5.4</font><font style="color:rgba(0, 0, 0, 0.75);"> </font>**<font style="color:rgba(0, 0, 0, 0.75);">以上的7.5.2和7.5.3可以大大降低计算量！！！！！！</font>**

#### <font style="color:rgb(79, 79, 79);">（三）图像噪声与中值滤波器</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">1.高斯噪声：（噪声服从N(μ,σ)正态分布）</font>![](/images/2aa046be17aa4a0b4c774703a619173f.png)
+ <font style="color:rgba(0, 0, 0, 0.75);">2.高斯噪声对应的处理方法自然是低通滤波器（高斯卷积核）</font>
+ <font style="color:rgba(0, 0, 0, 0.75);">3.椒盐噪声和脉冲噪声：对应的处理方法是中值滤波器（选原图卷积核感受野内n个数值的中值，既替换进去的值本就存在于原图中）</font>

### <font style="color:rgb(79, 79, 79);">二、卷积与边缘提取</font>
#### <font style="color:rgb(79, 79, 79);">（一）边缘提取</font>
+ <font style="color:rgb(77, 77, 77);">1.边缘：图像中亮度明显而急剧变化的点。</font>
+ <font style="color:rgb(77, 77, 77);">2.分析图像中边缘的种类：  
</font>![](/images/58ca337ce05e47d867a08563c99eea45.png)
+ <font style="color:rgb(77, 77, 77);">3.边缘检测方法：求导，导数最大处就是边缘</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">3.1数学视角—边缘检测的导数比较难求，Δ 趋近于0比较难算 ，为化简直接取1。</font>![](/images/129c55dddfdce64ce9fdf33d1b4174d0.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">3.2 转换为图像视角—Δ = 1，在图像中变化1，就是下一位的像素点。则上图公式变为 导数= 下一位像素点的值 - 本像素点的值。</font>
    - <font style="color:rgba(0, 0, 0, 0.75);">3.4 （与高斯卷积核可以拆分为2个一维高斯的成绩一样）将此处的边缘提取也划分为x、y两个方向，则可分别近似求出函数的x偏导和y偏导  
</font>![](/images/f3193da0f5795526ff020250d35090e8.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">3.5图像的梯度（和数学里的概念一样，由偏导组合起来的向量）</font>![](/images/269a6f47e1ad92b909d6a8c67039d660.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">3.6梯度的模值（图4级下公式）  
</font>![](/images/77bdab4b64b3d2629e2912082e8d3f1d.png)<font style="color:rgba(0, 0, 0, 0.75);"> 模值越大====》边缘的可能性越大</font>
+ <font style="color:rgb(77, 77, 77);">4.先通过高斯卷积核平滑图像+再通过图像的梯度提取边缘（为缓解图像噪声对梯度的影响，进而缓解对边缘提取的影响，直观的想到的方法高斯卷积核平滑）（PS：图一后侧标注“噪声信号”，应理解为“含噪声信号的信号”）  
</font>![](/images/823e6df17c74abf59f416a914c4f2f31.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">4.1显然的上图的运算过于麻烦（下面就看不懂了，只记结果吧）  
</font>![](/images/f3b6cb76565ae491ec0a6c9c5746a4aa.png)<font style="color:rgba(0, 0, 0, 0.75);">  
</font><font style="color:rgba(0, 0, 0, 0.75);">这就是“高斯一阶偏导卷积核”</font>
+ <font style="color:rgb(77, 77, 77);">5.提到高斯卷积核，就要讨论不同标准差情况下的卷积效果（窗口默认=2*3σ+1）  
</font>![](/images/b51c6da25ae4c8315027f8e45294cb2f.png)
+ <font style="color:rgb(77, 77, 77);">6.这是遇到了新问题，如果原图像是逐渐变亮\变暗的，则梯度变化是连续的，通过梯度提取的边界是有宽度的。但是我们想要的是一个锐利的边界。  
</font>![](/images/88b5eb195ed425b8b14c45b60a1c7990.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">6.1 使用非极大值抑制，提取出锐利的边缘（既每个点梯度和左右对比，梯度最大则留下，否则删除，效果如图）  
</font>![](/images/b021d042bea2422370bf034a6631f8d1.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">6.2 非最大化抑制会产生新的噪声，这是需要通过设置阈值进行调整，但是高阈值导致细节丢失、低阈值导致噪声去除不干净。这时引入双阈值操作方式：</font>**<font style="color:rgba(0, 0, 0, 0.75);">双阈值操作方式，是指提取高阈值和低阈值的边，之后用低阈值的边连接到高阈值的边上，能连接的保留，不能连接的低阈值边视为噪声丢弃。</font>**<font style="color:rgba(0, 0, 0, 0.75);">  
</font>![](/images/5f1d34c2e2fcdb3b88ea9dcd9a55ea6d.png)
    - <font style="color:rgba(0, 0, 0, 0.75);">6.3 以上</font>**<font style="color:rgba(0, 0, 0, 0.75);">高斯一阶偏导核卷积器+计算梯度和方向+非极大值抑制+双阈值提取操作 = canny边缘检测器</font>**<font style="color:rgba(0, 0, 0, 0.75);">。（目前为止最有效的边缘检测器）</font>
