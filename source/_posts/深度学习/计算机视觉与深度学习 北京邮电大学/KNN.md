---
title: KNN
date: '2024-07-26 10:19:07'
updated: '2025-08-21 16:18:38'
---
代码流程：

加载数据

load_CIFAR10

将训练集中每一个图片的data键和label键封为俩个元素X_train, y_train。同理测试集为 X_test, y_test

![](/images/009a4262a0645e9735dc6e024830fd56.png)

子采样

选取前5000个训练数据和500个测试数据

同时将图片展为一维数组<font style="color:rgb(59, 59, 59);">(5000, 3072) (500, 3072)</font>

训练

数据不变

二重循环L2距离

训练集么一行3072为一张照片的所有元素值

减去

测试集每一行一张图片的3072像素值

继续求L2距离得距离矩阵





预测标签

求距离矩阵中每一行元素（一张测试照片对应所有训练集照的距离）前k小的下标

代入Y_train得到对应标签值

再求出现次数最多的标签值



Question2

变为L1距离，且

1. 每个像素减去所有像素的均值

假设测试集减去的也是训练集得出的均值

那么实际距离不变

2. 每个像素减去对应位置像素均值

假设测试集减去的也是训练集得出的均值

那么实际距离不变

3. 每个元素减去均值再除以总体标准差![image](/images/784a2809704d2c8691962015e5ea9935.svg)

假设测试集减去的也是训练集得出的均值，除以的也是训练集的标准差

那么实际距离不变

![](/images/b7f452df904c95af017ac783be1fbd25.png)

4. 减去像素均值再除以像素标准差

假设测试集减去的也是训练集得出的均值，除以的也是训练集的标准差

由于每一个像素的均值和标准差不一致，再求距离中求和时，会导致求出的距离不一致



5. 旋转相同角度并且对空白元素填充相同空白值，不进行插值

空白元素相同，相减为0不会产生影响，







